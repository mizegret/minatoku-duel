:root {
  color-scheme: light dark;
  --bg: #f1fbff;
  --surface: rgba(255, 255, 255, 0.92);
  --fg: #0f172a;
  --muted: rgba(15, 23, 42, 0.6);
  --accent: #39eef0;
  --accent-dark: #14b8c2;
  --border: rgba(15, 23, 42, 0.12);
  --card-shadow: rgba(20, 184, 194, 0.15);
}

@media (prefers-color-scheme: dark) {
  :root {
    --bg: #061018;
    --surface: rgba(10, 22, 32, 0.88);
    --fg: #e6fbff;
    --muted: rgba(230, 251, 255, 0.65);
    --accent: #39eef0;
    --accent-dark: #1fd9e4;
    --border: rgba(57, 238, 240, 0.28);
    --card-shadow: rgba(57, 238, 240, 0.22);
  }
}

* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: 'Noto Sans JP', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: var(--bg);
  color: var(--fg);
}

html, body { height: 100%; }

main {
  max-width: 960px;
  margin: 0 auto;
  padding: 24px 16px 64px;
  display: flex;
  flex-direction: column;
  gap: 32px;
}

/* Hybrid (use more screen on desktop) */
.pixi-hybrid body { overflow: hidden; }
.pixi-hybrid main {
  max-width: none;
  width: 100vw;
  height: 100vh;
  padding: 12px 24px 16px;
}

#screen-lobby,
#screen-room {
  background: var(--surface);
  padding: 24px;
  border-radius: 16px;
  box-shadow: 0 18px 40px var(--card-shadow);
}

h1 { margin: 0 0 16px; font-size: 1.8rem; }

button {
  cursor: pointer;
  padding: 10px 18px;
  border-radius: 999px;
  border: 1px solid transparent;
  background: linear-gradient(135deg, var(--accent), var(--accent-dark));
  color: #06252b;
  font-size: 0.95rem;
  transition: transform 0.1s ease, box-shadow 0.1s ease, filter 0.1s ease;
}
button:hover { transform: translateY(-1px); box-shadow: 0 12px 24px var(--card-shadow); filter: brightness(1.05); }
button:disabled { background: #cfdbe0; color: #56626d; box-shadow: none; cursor: not-allowed; }

.note { margin-top: 12px; font-size: 0.9rem; color: var(--muted); }

header {
  display: flex; flex-wrap: wrap; gap: 12px 16px; align-items: center; margin-bottom: 24px;
}
header p { margin: 0; }
#turn-indicator { margin-left: auto; font-weight: 600; letter-spacing: 0.02em; }

.board { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 16px; margin-bottom: 24px; }
.canvas-center { background: rgba(10, 22, 32, 0.2); border: 1px solid var(--border); border-radius: 14px; min-height: 380px; position: relative; overflow: hidden; }

/* Pixi hybrid layout: left=hand(HTML), center=canvas, right=log(HTML) */
.pixi-hybrid #screen-room { height: 100%; display: grid; grid-template-rows: auto 1fr; }
.pixi-hybrid .board { grid-template-columns: 340px 1fr 360px; align-items: stretch; column-gap: 20px; height: 100%; min-height: 0; margin-bottom: 0; }
.pixi-hybrid #canvas-center { height: 100%; min-height: 0; }
.pixi-hybrid .player-self, .pixi-hybrid .player-opponent { height: 100%; }
.pixi-hybrid .player { min-height: 0; overflow: hidden; }
.pixi-hybrid .player-self .hand {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 12px;
  flex: 1 1 auto;
  min-height: 0;
  overflow-y: auto;
  overscroll-behavior: contain;
  padding-right: 6px;
  align-content: start;
}
.pixi-hybrid .player-self .hand .card {
  min-width: 0; width: 100%;
  aspect-ratio: 63 / 88; /* TCG-like */
  display: flex; align-items: center; justify-content: center;
  padding: 0;
  font-weight: 600; font-size: .9rem; text-align: center;
}
@media (max-width: 880px) {
  .pixi-hybrid .player-self .hand { grid-template-columns: 1fr; }
}
.pixi-hybrid .player-opponent > h2, .pixi-hybrid .player-opponent .deck { display: none; }
.pixi-hybrid #log-vertical { background: rgba(255, 255, 255, 0.72); border-radius: 12px; padding: 12px; flex: 1 1 auto; min-height: 0; overflow-y: auto; overscroll-behavior: contain; display: flex; flex-direction: column; gap: 6px; }
@media (prefers-color-scheme: dark) {
  .pixi-hybrid #log-vertical { background: rgba(15, 32, 40, 0.65); color: rgba(230, 251, 255, 0.78); }
}
.pixi-hybrid section.log { display: none; }
.player { background: var(--surface); border: 1px solid var(--border); border-radius: 14px; padding: 16px; display: flex; flex-direction: column; gap: 12px; box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.25); }
.player h2 { margin: 0; font-size: 1.1rem; }
.hand, .field { display: flex; flex-wrap: wrap; gap: 8px; }
.card { min-width: 120px; padding: 10px 12px; border-radius: 12px; border: 1px solid var(--border); background: #ffffff; box-shadow: 0 4px 14px var(--card-shadow); font-size: 0.95rem; }
.player-self .hand .card { cursor: pointer; transition: transform .1s ease, box-shadow .1s ease, border-color .1s ease; }
.player-self .hand .card:hover { transform: translateY(-2px); box-shadow: 0 12px 22px var(--card-shadow); border-color: var(--accent); }
.player-self .hand.disabled .card { pointer-events: none; cursor: not-allowed; opacity: 0.6; }
.player-opponent .hand .card { pointer-events: none; cursor: default; }
.card.masked { letter-spacing: .08em; text-align: center; }

.field-human { flex: 1 1 160px; border: 1px dashed var(--border); border-radius: 16px; padding: 14px; background: rgba(57, 238, 240, 0.12); display: flex; flex-direction: column; gap: 10px; }
.field-human-card { background: #ffffff; border-radius: 12px; border: 1px solid var(--border); padding: 12px; font-weight: 600; box-shadow: 0 4px 14px var(--card-shadow); min-width: 130px; }
.field-human-decorations { display: flex; gap: 8px; flex-wrap: wrap; }
.decoration-slot { min-width: 98px; padding: 6px 10px; border-radius: 999px; border: 1px dashed var(--border); font-size: 0.8rem; color: var(--muted); text-align: center; background: rgba(15, 23, 42, 0.04); }
.decoration-slot.has-decoration { border: 1px solid rgba(57, 238, 240, 0.6); background: rgba(57, 238, 240, 0.18); color: var(--fg); font-weight: 600; }

.actions { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 18px; }
.scores { display: flex; gap: 18px; flex-wrap: wrap; font-weight: 600; }
.deck { font-size: 0.9rem; color: var(--muted); margin-bottom: 8px; }
.deck-count { display: inline-block; min-width: 24px; text-align: center; font-weight: 700; color: var(--fg); background: rgba(15,23,42,.06); border: 1px solid var(--border); border-radius: 999px; padding: 2px 8px; }
.section-label { margin: 6px 0 4px; font-size: 0.85rem; color: var(--muted); }

.log {
  background: rgba(255, 255, 255, 0.72);
  border-radius: 12px;
  border: 1px solid var(--border);
  padding: 12px;
  min-height: 72px;
  max-height: 220px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  font-size: 0.9rem;
  color: var(--muted);
  margin-top: 12px;
  overflow-y: auto;
}
.log-entry { display: flex; align-items: center; gap: 6px; }
.log-entry::before { content: ''; width: 6px; height: 6px; border-radius: 50%; background: var(--accent); display: inline-block; }
.log-entry.action-summon::before { background: #10b981; }
.log-entry.action-decorate::before { background: #facc15; }
.log-entry.action-play::before { background: #f97316; }
.log-entry.action-skip::before { background: #94a3b8; }
.log-entry.action-network::before { background: #38bdf8; }
.log-entry time { font-size: 0.8rem; color: rgba(15, 23, 42, 0.45); }

@media (prefers-color-scheme: dark) {
  .log { background: rgba(15, 32, 40, 0.65); color: rgba(230, 251, 255, 0.78); }
  .log-entry time { color: rgba(230, 251, 255, 0.5); }
}

@media (prefers-color-scheme: dark) {
  .card { background: rgba(10, 32, 40, 0.95); color: var(--fg); }
  .field-human { background: rgba(23, 94, 110, 0.35); }
  .field-human-card { background: rgba(10, 32, 40, 0.95); color: var(--fg); }
  .decoration-slot { border: 1px dashed rgba(57, 238, 240, 0.35); background: rgba(10, 32, 40, 0.55); color: rgba(230, 251, 255, 0.8); }
  .decoration-slot.has-decoration { border: 1px solid rgba(57, 238, 240, 0.6); background: rgba(57, 238, 240, 0.3); color: var(--fg); }
}

@media (max-width: 640px) {
  main { padding: 16px 12px 48px; }
  header { flex-direction: column; align-items: flex-start; }
  #turn-indicator { margin-left: 0; }
  .card { min-width: 100px; }
}
.pixi-hybrid header { margin-bottom: 8px; }
.pixi-hybrid main { gap: 16px; }
.notice-inline { color: var(--muted); font-weight: 600; }
.notice-inline[hidden] { display: none !important; }

/* inline scores in header */
.scores-inline { display: flex; gap: 14px; font-weight: 600; margin-left: 8px; white-space: nowrap; }
.scores-inline div { display: flex; gap: 6px; align-items: baseline; }
